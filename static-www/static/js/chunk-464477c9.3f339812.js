(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-464477c9"],{"0b21":function(e,t,n){var r=n("5ca1");r(r.S,"Math",{sign:n("96fb")})},"70eb":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n("6c7b"),n("55dd"),n("a481");var r=n("2d36"),i=n("4360");function o(e){var t=e.items,n=e.predict,r=e.reason,i=e.filter_record,o=t.length;t=n(t);var a=t.length,s=o-a;return 0===s||(i[r]=s),t}function a(e,t){var n=t.problem_range_start,a=t.problem_range_end,u=t.shuffle_problem,l=t.shuffle_problem_options,f=t.new_problem,d=t.combo_problem,p=t.problem_max_num;n=n||1,a=a||e.length,u=u||!1,l=l||!1,f=f||!1,d=d||0,p=p||0;var m=i["a"].state.problems.current_problems,_={},h=e;return h=o({items:h,predict:function(e){return e.filter((function(e){return e}))},reason:"重复的题目",filter_record:_}),h=o({items:h,predict:function(e){return e.slice(n-1,a||e.length)},reason:"筛选题目范围",filter_record:_}),u&&(h=Object(r["b"])(h)),c(h,l),s(h),d&&(h=o({items:h,predict:function(e){return e.filter((function(e){return(m[e.id]&&m[e.id].combo_kill||0)<d}))},reason:"筛选连对",filter_record:_})),f&&(h=o({items:h,predict:function(e){return e.filter(e.filter((function(e){return!(m[e.id]&&m[e.id].total)})))},reason:"筛选新题",filter_record:_})),p>0&&(h=o({items:h,predict:function(e){return e.slice(0,p)},reason:"筛选最大刷题数",filter_record:_})),{items:h,filter_record:_}}function s(e){e.map((function(e){if(e.options){var t=e.analysis;t?e.option_map&&(e.option_map.map((function(e,n){t=t.replace("{{OPT:".concat(e+1,"}}"),"[".concat(n+1,"]"))})),e.analysis=t):e.analysis="暂无题解"}}))}function c(e,t){var n=function(e,t,n){var r=t.map((function(n,r){var i=e[r];return t[i]})),i={};e.map((function(e,t){i[e]=t}));var o=function(e){return i[e-1]+1},a=n.length?n.map(o).sort((function(e,t){return e-t})):o(n);return[r,a]};e.map((function(e){if(e.options){var i=e.options,o=e.answer,a=e.analysis,s=function(e){return e&&e>0&&e<=i.length};o&&o.length?(o=o.filter(s),o.length||(o=[1],a="(该题答案存在问题)".concat(a))):s(o)||(o=1,a="(该题答案存在问题)".concat(a));var c=new Array(i.length).fill(0).map((function(e,t){return t}));if(t){console.log("start shuffle options"),c=Object(r["b"])(c);var u=n(c,i,o,a);e.options=u[0],e.answer=u[1]}e.option_map=c}}))}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;return new Promise((function(e,r){var i={};n=n.map((function(e){var t=Object.assign({},e);return t.id||(t.id="".concat(e.content).concat(JSON.stringify(e.answer))),i[t.id]?(i[t.id]++,null):(i[t.id]=1,t.completed=null,t)}));var o=n.length,s=a(n,t),c=s.items,u=s.filter_record;return n=c.map((function(e,t){return Object.assign({page_index:t},e)})),e({problems:n,duplicated:i,total_count:o,filter_record:u})}))}},"96fb":function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},e2dd:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("589d"),i=n.n(r);function o(e){e.style.opacity=0,e.style["margin-left"]="5rem"}function a(e,t){var n=150*(e.dataset.index||0);setTimeout((function(){i()(e,{"margin-left":"",opacity:1},{complete:t})}),n)}function s(e,t){return this.beforeEnter(e)}},f7cd:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"problem-list",staticStyle:{"min-height":"50rem"}},[n("transition-group",{staticClass:"slide-container",attrs:{name:"slide-fade",mode:"out-in",tag:"ul"},on:{enter:e.enter,"before-enter":e.beforeEnter,"before-leave":e.beforeLeave}},e._l(e.focus_data,(function(t,r){return n("li",{directives:[{name:"show",rawName:"v-show",value:e.problem_show(t),expression:"problem_show(d)"}],key:t.id,staticClass:"slide-fade-item",attrs:{"data-index":r}},[n("Problem",e._b({ref:"p"+t.page_index,refInFor:!0,attrs:{data:t,index:t.page_index,completed:t.completed,focus:e.current_focus===t.id,preferences:e.preferences},on:{"update:completed":function(n){return e.$set(t,"completed",n)},onSubmit:function(n){return e.onSubmit(Object.assign(n,{problem:t}))},requireFocus:function(n){return e.handle_focus({id:t.id,is_manual:!0})}}},"Problem",e.$props,!1))],1)})),0),e._v(" "),n("CompletionTip",{ref:"completion_tip",on:{onStatus:function(t){return e.$emit("onStatus",t)},requireResetProblem:function(t){return e.reset_by_dict(t)}}}),e._v(" "),n("el-backtop",{attrs:{target:".train"}})],1)},i=[],o=(n("ac6a"),n("456d"),n("96cf"),n("1da1")),a=(n("0b21"),n("7514"),n("20d6"),n("e2dd")),s=n("ed08"),c=n("70eb"),u={name:"ProblemList",components:{Problem:function(){return n.e("chunk-399b4592").then(n.bind(null,"e39d"))},CompletionTip:function(){return n.e("chunk-2d0aaf0a").then(n.bind(null,"12c6"))}},props:{data:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,current_focus:null,filtered_data:null,filter_record:{}}},computed:{preferences:function(){var e=this.$store.state.problems.preferences,t=e&&e.practice;return t},current_index:function(){var e=this.current_focus,t=this.filtered_data;if(!e||!t)return-1;var n=t.findIndex((function(t){return t.id===e}));return n},current_problems:function(){return this.$store.state.problems.current_problems},options:function(){return this.$store.state.problems.current_options},kill_problem:function(){return this.options&&this.options.kill_problem},requireReset:function(){var e=this;return Object(s["b"])((function(){e.reset({})}),200)},focus_data:function(){var e=this,t=this.filtered_data;if(!t)return t;var n=this.current_index,r=this.options.show_max_problem_range,i=[0,t.length],o=[],a=function(o){var a=n,s=0,c=[];while(s<r){if(a+=o,a<i[0]||a>=i[1])break;var u=t[a];e.problem_show(u)&&(c.push(u),s++)}return c};return o=o.concat(a(-1).reverse()),t[n]&&o.push(t[n]),o=o.concat(a(1)),o}},watch:{data:{handler:function(e){this.requireReset()},immediate:!0},options:{handler:function(e){this.requireReset()},immediate:!0,deep:!0}},mounted:function(){document.addEventListener("keyup",this.onKeyUp)},destroyed:function(){document.removeEventListener("keyup",this.onKeyUp)},methods:{beforeEnter:a["a"],enter:a["c"],beforeLeave:a["b"],problem_show:function(e){if(e)return!this.kill_problem||!e.completed||e.completed>(new Date).getTime()-1e3},onKeyUp:function(e){var t=e.ctrlKey,n=e.shiftKey,r=e.key;if(t&&n){var i={is_manual:!0,new_focus:0};"ArrowUp"===r?i.focus_move_step=-1:"ArrowDown"===r&&(i.focus_move_step=1),this.focus_next(i)}},handle_focus:function(e){var t=e.id,n=e.is_manual,r=void 0!==n&&n;console.log("handle_focus",t);var i=this.current_focus,o=this.filtered_data;if(i!==t){var a=o.find((function(e){return e.id===t}));if(!a)return console.warn("题目不存在");r&&this.$message.success("已选中第".concat(a.page_index+1,"题，可以提交它了。")),this.current_focus=t}},focus_next:function(e){var t=e.focus_move_step,n=e.is_manual,r=void 0!==n&&n,i=this.filtered_data,o=this.current_index,a=Math.sign(t),s=o;while(0!==t){if(s+=a,!i[s])return console.warn("已无题可被选中啦");i[s].completed||(t-=a)}console.log("focus to",s),this.handle_focus({id:i[s].id,is_manual:r})},onSubmit:function(e){var t=e.problem,n=e.is_right;console.log("onsubmit to status",t),this.$refs.completion_tip.update_status({problem:t,is_right:n}),this.focus_next({focus_move_step:1})},reset:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,i,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.data,r=t.is_manual,!r){e.next=9;break}return e.next=4,this.$confirm("是否要刷新题目").catch((function(e){}));case 4:if(i=e.sent,"confirm"===i){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.$store.dispatch("problems/update_database");case 9:this.filtered_data=null,console.log("problem list reseting"),this.$nextTick((function(){o.init(n)}));case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),reset_by_dict:function(e){var t=e.dict,n=e.is_manual,r=t?this.filtered_data.filter((function(e){return void 0!==t[e.id]})).map((function(e){return delete e.page_index,e})):null;return this.reset({data:r,is_manual:n})},init:function(e){var t=this;if(!this.options)return this.$emit("requireInit");this.loading=!0,Object(c["a"])(e||this.data,this.options).then((function(e){var n=e.problems,r=e.duplicated,i=e.total_count,o=e.filter_record;t.filtered_data=n,t.filter_record=o,t.$refs.completion_tip.init_status({problems:n,duplicated:r}),t.$refs.completion_tip.init_wrong_set(n),setTimeout((function(){var e=t.filtered_data.length,n=i-e,r=t.filter_record;n>0&&t.$notify.warning({title:"本轮共筛选出".concat(e,"题，其他的").concat(n,"道题被隐藏啦~"),message:Object.keys(r).map((function(e){return"".concat(e,":").concat(r[e],"道")})).join(";")});var o=t.filtered_data[0];o&&t.handle_focus({id:o.id})}),200)})).finally((function(){t.loading=!1}))}}},l=u,f=n("2877"),d=Object(f["a"])(l,r,i,!1,null,"12921f41",null);t["default"]=d.exports}}]);