(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b214a"],{"231d":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"按姓名查找"},on:{input:e.handleUserSelectByRealnameChange},model:{value:e.nowSelectRealName,callback:function(a){e.nowSelectRealName=a},expression:"nowSelectRealName"}}),e._v(" "),t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadNextPage,expression:"loadNextPage"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-collapse",{attrs:{accordion:""},on:{change:e.selectUserChange},model:{value:e.nowCollapseSelectUserId,callback:function(a){e.nowCollapseSelectUserId=a},expression:"nowCollapseSelectUserId"}},e._l(e.usersByRealName,(function(a,n){return t("el-collapse-item",{key:a.id,attrs:{name:a.id}},[t("template",{slot:"title"},[t("el-tag",[e._v(e._s(a.dutiesName))]),e._v("\n          "+e._s(a.companyName)+" "+e._s(a.realName)+"\n        ")],1),e._v(" "),t("User",{attrs:{data:a,"can-load-avatar":a.canLoadAvatar,avatar:e.usersByRealName[n].avatar},on:{"update:avatar":function(a){return e.$set(e.usersByRealName[n],"avatar",a)},"avatar-load":function(a){return e.avatarLoad(n)}}})],2)})),1),e._v(" "),e.hasNextPage?t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{type:"text"},on:{click:e.loadNextPage}},[e._v(e._s(e.loading?"加载中...":"点击加载更多记录"))]):t("div",{staticStyle:{height:"1px","background-color":"#dcdfe6",margin:"0.5rem 0.2rem"}})],1)],1)},l=[],s=t("345a"),o=t("211b"),i={name:"FindUserByRealName",components:{User:s["default"]},model:{prop:"code",event:"change"},props:{code:{type:String,default:null}},data:function(){return{loading:!1,nowSelectRealName:"",nowIndex:0,usersByRealName:[],userDict:{},nowCollapseSelectUserId:"",hasNextPage:!1}},watch:{usersByRealName:{handler:function(e){if(e){this.userDict={};for(var a=e.length,t=0;t<a;t++)this.userDict[e[t].id]=e[t]}}}},methods:{avatarLoad:function(e){var a=this;this.$nextTick((function(){a.$emit("update:avatar",a.usersByRealName[e].avatar)}))},selectUserChange:function(e){e&&this.loadCollapseUserAvatarRealName(e)},loadCollapseUserAvatarRealName:function(e){var a=this.userDict[e];this.$emit("change",a),a.avatar?this.$emit("update:avatar",a.avatar):a.canLoadAvatar=!0,this.$message.success("已选择:".concat(a.realName,"(").concat(a.id,")"))},handleUserSelectByRealnameChange:function(){this.usersByRealName=[],this.nowSelectRealName&&(this.hasNextPage=!0,this.nowIndex=0,this.loadNextPage())},loadNextPage:function(){var e=this,a=this.nowSelectRealName;if(!this.loading&&a&&this.hasNextPage){this.loading=!0;var t={realName:a,pageIndex:this.nowIndex++,pageSize:10,fuzz:!0};Object(o["h"])(t).then((function(a){e.usersByRealName=e.usersByRealName.concat(a.list.map((function(e){return e.canLoadAvatar=!1,e.avatar=null,e}))),e.hasNextPage=a.totalCount>e.usersByRealName.length})).finally((function(){e.loading=!1}))}}}},r=i,c=t("2877"),d=Object(c["a"])(r,n,l,!1,null,null,null);a["default"]=d.exports}}]);